<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scooty Bot - Architecture Syst√®me</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #8B5CF6, #A855F7);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        .content {
            padding: 40px;
        }
        .section {
            margin-bottom: 40px;
        }
        .section h2 {
            color: #8B5CF6;
            border-bottom: 3px solid #E5E7EB;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .section h3 {
            color: #6B46C1;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        .architecture-diagram {
            background: linear-gradient(135deg, #F8FAFC, #F1F5F9);
            border: 2px solid #E2E8F0;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            position: relative;
        }
        .component {
            background: white;
            border: 2px solid #8B5CF6;
            border-radius: 10px;
            padding: 15px;
            margin: 10px;
            display: inline-block;
            min-width: 150px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .component.primary {
            background: linear-gradient(135deg, #8B5CF6, #A855F7);
            color: white;
            border-color: #6B46C1;
        }
        .component.database {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            border-color: #047857;
        }
        .component.cache {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
            border-color: #B45309;
        }
        .component.external {
            background: linear-gradient(135deg, #6B7280, #4B5563);
            color: white;
            border-color: #374151;
        }
        .flow-arrow {
            display: inline-block;
            margin: 0 15px;
            font-size: 1.5em;
            color: #8B5CF6;
        }
        .layer {
            background: rgba(139, 92, 246, 0.1);
            border-left: 4px solid #8B5CF6;
            padding: 20px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
        }
        .layer h4 {
            color: #6B46C1;
            margin: 0 0 15px 0;
            font-size: 1.2em;
        }
        .data-flow {
            background: #FEF3C7;
            border: 2px solid #F59E0B;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        .security-zone {
            background: #FEF2F2;
            border: 2px solid #EF4444;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        .performance-box {
            background: #F0FDF4;
            border: 2px solid #10B981;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        .code-block {
            background: #1F2937;
            color: #F9FAFB;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .metric-card {
            background: linear-gradient(135deg, #EDE9FE, #DDD6FE);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #C4B5FD;
        }
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #6B46C1;
        }
        .metric-label {
            color: #6B7280;
            margin-top: 5px;
        }
        ul, ol {
            line-height: 1.8;
        }
        li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèóÔ∏è Architecture Syst√®me</h1>
            <p>Scooty Bot MTG - Design & Infrastructure</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>üéØ Vue d'Ensemble Architecture</h2>
                
                <div class="architecture-diagram">
                    <h3 style="text-align: center; color: #6B46C1; margin-bottom: 30px;">Architecture Globale</h3>
                    
                    <div style="text-align: center;">
                        <div class="component external">
                            <strong>üë• Discord</strong><br>
                            Utilisateurs MTG
                        </div>
                        
                        <div class="flow-arrow">‚¨áÔ∏è</div>
                        
                        <div class="component primary">
                            <strong>ü§ñ Scooty Bot</strong><br>
                            Discord.js v14<br>
                            TypeScript
                        </div>
                        
                        <div style="margin: 20px 0;">
                            <div class="flow-arrow">‚¨ÖÔ∏è</div>
                            <div class="component cache" style="margin: 0 20px;">
                                <strong>‚ö° Redis Cache</strong><br>
                                Donn√©es fr√©quentes<br>
                                TTL intelligent
                            </div>
                            <div class="flow-arrow">‚û°Ô∏è</div>
                        </div>
                        
                        <div class="flow-arrow">‚¨áÔ∏è</div>
                        
                        <div class="component database">
                            <strong>üóÑÔ∏è Supabase</strong><br>
                            PostgreSQL<br>
                            RLS + Auth
                        </div>
                        
                        <div style="margin-top: 30px;">
                            <div class="component external" style="margin: 0 10px;">
                                <strong>‚òÅÔ∏è Fly.io</strong><br>
                                Hosting Global
                            </div>
                            <div class="component external" style="margin: 0 10px;">
                                <strong>üîÑ GitHub Actions</strong><br>
                                CI/CD Pipeline
                            </div>
                            <div class="component external" style="margin: 0 10px;">
                                <strong>üìä Monitoring</strong><br>
                                Logs + M√©triques
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üìö Architecture en Couches</h2>
                
                <div class="layer">
                    <h4>üéÆ Couche Pr√©sentation (Discord Interface)</h4>
                    <ul>
                        <li><strong>Commandes Slash</strong> - Interface utilisateur principale</li>
                        <li><strong>Auto-compl√©tion</strong> - UX optimis√©e avec suggestions</li>
                        <li><strong>Embeds riches</strong> - Affichage format√© des donn√©es</li>
                        <li><strong>Gestion des erreurs</strong> - Messages utilisateur clairs</li>
                    </ul>
                </div>

                <div class="layer">
                    <h4>üß† Couche Logique M√©tier (Commands & Services)</h4>
                    <ul>
                        <li><strong>CommandHandler</strong> - Routage et validation des commandes</li>
                        <li><strong>ScoutService</strong> - Logique de scouting MTG</li>
                        <li><strong>StatsService</strong> - Calculs et agr√©gations</li>
                        <li><strong>ValidationService</strong> - Contr√¥le des donn√©es</li>
                    </ul>
                </div>

                <div class="layer">
                    <h4>üíæ Couche Donn√©es (Database & Cache)</h4>
                    <ul>
                        <li><strong>DatabaseService</strong> - Abstraction Supabase</li>
                        <li><strong>CacheService</strong> - Gestion Redis intelligente</li>
                        <li><strong>Repository Pattern</strong> - S√©paration des pr√©occupations</li>
                        <li><strong>Migration System</strong> - √âvolution du sch√©ma</li>
                    </ul>
                </div>

                <div class="layer">
                    <h4>üîß Couche Infrastructure (Hosting & Monitoring)</h4>
                    <ul>
                        <li><strong>Container Docker</strong> - Environnement isol√©</li>
                        <li><strong>Load Balancing</strong> - Distribution de charge</li>
                        <li><strong>Health Checks</strong> - Surveillance continue</li>
                        <li><strong>Log Aggregation</strong> - Centralisation des logs</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>üîÑ Flux de Donn√©es</h2>
                
                <div class="data-flow">
                    <h4>üìù Flux Commande /scout</h4>
                    <div class="code-block">
1. Utilisateur ‚Üí Discord ‚Üí /scout command
2. Bot ‚Üí Validation des param√®tres
3. Bot ‚Üí Auto-compl√©tion arch√©types (Cache/DB)
4. Bot ‚Üí Insertion scout en base
5. Bot ‚Üí Invalidation cache stats
6. Bot ‚Üí Confirmation utilisateur
7. Bot ‚Üí Log de l'action
                    </div>
                </div>

                <div class="data-flow">
                    <h4>üìä Flux Commande /stats</h4>
                    <div class="code-block">
1. Utilisateur ‚Üí Discord ‚Üí /stats command
2. Bot ‚Üí V√©rification cache Redis
3. Si cache HIT ‚Üí Retour imm√©diat
4. Si cache MISS ‚Üí Requ√™te Supabase
5. Bot ‚Üí Calcul des statistiques
6. Bot ‚Üí Mise en cache (TTL 5min)
7. Bot ‚Üí Affichage embed format√©
                    </div>
                </div>

                <div class="data-flow">
                    <h4>üîç Flux Commande /check</h4>
                    <div class="code-block">
1. Utilisateur ‚Üí Discord ‚Üí /check player
2. Bot ‚Üí Recherche fuzzy en cache
3. Bot ‚Üí Requ√™te historique complet
4. Bot ‚Üí Agr√©gation par √©v√©nement
5. Bot ‚Üí Formatage embed d√©taill√©
6. Bot ‚Üí Affichage avec pagination
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üóÑÔ∏è Mod√®le de Donn√©es</h2>
                
                <div class="architecture-diagram">
                    <h3 style="text-align: center; color: #6B46C1;">Relations Base de Donn√©es</h3>
                    
                    <div style="display: flex; justify-content: space-around; flex-wrap: wrap; margin-top: 30px;">
                        <div class="component database" style="width: 200px;">
                            <strong>üèÜ EVENTS</strong><br>
                            <small>
                                ‚Ä¢ id (PK)<br>
                                ‚Ä¢ name<br>
                                ‚Ä¢ format<br>
                                ‚Ä¢ dates<br>
                                ‚Ä¢ is_active
                            </small>
                        </div>
                        
                        <div class="component database" style="width: 200px;">
                            <strong>üìä SCOUTS</strong><br>
                            <small>
                                ‚Ä¢ id (PK)<br>
                                ‚Ä¢ player_name<br>
                                ‚Ä¢ archetype<br>
                                ‚Ä¢ event_id (FK)<br>
                                ‚Ä¢ result<br>
                                ‚Ä¢ notes
                            </small>
                        </div>
                        
                        <div class="component database" style="width: 200px;">
                            <strong>üÉè ARCHETYPES</strong><br>
                            <small>
                                ‚Ä¢ id (PK)<br>
                                ‚Ä¢ name<br>
                                ‚Ä¢ format<br>
                                ‚Ä¢ colors<br>
                                ‚Ä¢ tier
                            </small>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <div class="component" style="background: #F3E8FF;">
                            <strong>üìà VUES MAT√âRIALIS√âES</strong><br>
                            <small>
                                ‚Ä¢ player_stats_view<br>
                                ‚Ä¢ archetype_meta_view<br>
                                ‚Ä¢ event_summary_view
                            </small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üîí S√©curit√© & Isolation</h2>
                
                <div class="security-zone">
                    <h4>üõ°Ô∏è P√©rim√®tres de S√©curit√©</h4>
                    
                    <h5>Niveau Application</h5>
                    <ul>
                        <li><strong>Token Discord</strong> - Authentification bot s√©curis√©e</li>
                        <li><strong>Rate Limiting</strong> - Protection contre le spam</li>
                        <li><strong>Input Validation</strong> - Sanitisation des entr√©es</li>
                        <li><strong>Error Handling</strong> - Pas de fuite d'informations</li>
                    </ul>

                    <h5>Niveau Base de Donn√©es</h5>
                    <ul>
                        <li><strong>Row Level Security (RLS)</strong> - Isolation par serveur Discord</li>
                        <li><strong>Chiffrement au repos</strong> - Donn√©es prot√©g√©es</li>
                        <li><strong>Connection SSL</strong> - Transit s√©curis√©</li>
                        <li><strong>Audit Logs</strong> - Tra√ßabilit√© compl√®te</li>
                    </ul>

                    <h5>Niveau Infrastructure</h5>
                    <ul>
                        <li><strong>Secrets Management</strong> - Variables d'environnement</li>
                        <li><strong>Network Isolation</strong> - VPC priv√©</li>
                        <li><strong>HTTPS Only</strong> - Communications chiffr√©es</li>
                        <li><strong>Backup Encryption</strong> - Sauvegardes s√©curis√©es</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>‚ö° Performance & Scalabilit√©</h2>
                
                <div class="performance-box">
                    <h4>üéØ Objectifs de Performance</h4>
                    
                    <div class="metric-grid">
                        <div class="metric-card">
                            <div class="metric-value">&lt; 250ms</div>
                            <div class="metric-label">Latence Commandes</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">‚â• 99%</div>
                            <div class="metric-label">Disponibilit√©</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">&gt; 80%</div>
                            <div class="metric-label">Cache Hit Ratio</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">1000+</div>
                            <div class="metric-label">Utilisateurs Concurrent</div>
                        </div>
                    </div>

                    <h5>Strat√©gies d'Optimisation</h5>
                    <ul>
                        <li><strong>Cache Multi-Niveaux</strong> - Redis + Cache applicatif</li>
                        <li><strong>Index Optimis√©s</strong> - Requ√™tes SQL rapides</li>
                        <li><strong>Connection Pooling</strong> - R√©utilisation des connexions</li>
                        <li><strong>Lazy Loading</strong> - Chargement √† la demande</li>
                        <li><strong>Compression</strong> - R√©duction bande passante</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>üöÄ D√©ploiement & Scalabilit√©</h2>
                
                <div class="architecture-diagram">
                    <h3 style="text-align: center; color: #6B46C1;">Infrastructure Fly.io</h3>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <div class="component external">
                            <strong>üåç Edge Locations</strong><br>
                            D√©ploiement Global<br>
                            Latence Optimis√©e
                        </div>
                        
                        <div class="flow-arrow">‚¨áÔ∏è</div>
                        
                        <div style="display: flex; justify-content: center; gap: 20px; margin: 20px 0;">
                            <div class="component primary">
                                <strong>üá∫üá∏ US-East</strong><br>
                                Instance Principale
                            </div>
                            <div class="component primary">
                                <strong>üá™üá∫ EU-West</strong><br>
                                Instance Secondaire
                            </div>
                        </div>
                        
                        <div class="flow-arrow">‚¨áÔ∏è</div>
                        
                        <div class="component database">
                            <strong>üóÑÔ∏è Supabase Multi-Region</strong><br>
                            Read Replicas<br>
                            Backup Automatique
                        </div>
                    </div>
                </div>

                <h3>Configuration Auto-Scaling</h3>
                <div class="code-block">
# fly.toml - Configuration scaling
[services.concurrency]
  type = "connections"
  hard_limit = 1000
  soft_limit = 800

[[services.http_checks]]
  interval = "10s"
  timeout = "2s"
  grace_period = "5s"
  method = "GET"
  path = "/health"

[metrics]
  port = 9091
  path = "/metrics"
                </div>
            </div>

            <div class="section">
                <h2>üìä Monitoring & Observabilit√©</h2>
                
                <h3>Dashboards Principaux</h3>
                <ul>
                    <li><strong>Application Health</strong> - Uptime, latence, erreurs</li>
                    <li><strong>Business Metrics</strong> - Commandes/jour, utilisateurs actifs</li>
                    <li><strong>Infrastructure</strong> - CPU, m√©moire, r√©seau</li>
                    <li><strong>Database Performance</strong> - Requ√™tes lentes, connexions</li>
                </ul>

                <h3>Alertes Configur√©es</h3>
                <div class="code-block">
# Exemples d'alertes critiques
- Latence P95 > 500ms (5min)
- Taux d'erreur > 5% (2min)  
- CPU > 80% (10min)
- M√©moire > 90% (5min)
- Cache hit ratio < 70% (15min)
- Database connections > 80 (5min)
                </div>
            </div>
        </div>
    </div>
</body>
</html> 